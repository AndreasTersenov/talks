<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Presentation for CCA Predoc interview, Mar2025</title>
	<meta name="description" content="A basic template to start a new talk">
	<meta name="author" content="Andreas Tersenov">

	<link rel="stylesheet" href="reveal.js/dist/reset.css">
	<link rel="stylesheet" href="reveal.js/dist/reveal.css">
	<link rel="stylesheet" href="reveal.js/dist/theme/darkenergy.css">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">
</head>


<body>
	<div class="reveal">
		<div class="slides">

			<!-- ################################################################################################### -->

			<section data-background-iframe="background.html">
				<div class="container">
					<div class="title" style="border-radius: 20px; background-color:rgba(0, 0, 0, 0.5);">
						<h2><b class="alert">Advanced Inference in Weak Lensing: Mass Mapping and Higher-Order
								Statistics for Precision Cosmology</b>
						</h2>
						<h3>March 28th, 2025</h3>
					</div>
				</div>
				<hr>
				<div style="border-radius: 20px; background-color:rgba(0, 0, 0, 0);">
					<!-- <div class="container">
						<div class="col">
							<div align="left" style="margin-left: 20px;">
								<h3>Andreas Tersenov</h3>
								<br>
								<img src="assets/forth_en1.png" class="plain" height="60"></img>
								<br>
							</div>
						</div>

						<div class="col">
							<br>
							<br>
							<br>
							<img src="assets/logo-FORTH-IoA_1.png" class="plain" height="70"></img>
						</div>
						<div class="col">
							<br>
							<br>
							<br>
							<img src="assets/logo-FORTH-IoA_2.png" class="plain" height="100"></img>
						</div>
						<div class="col">
							<br>
							<br>
							<br>
							<br>
							<img src="assets/logo-crete.png" class="plain" height="120"></img>
						</div>
					</div>
					 <div> slides at <a
							href="https://andreastersenov.github.io/talks/TITAN_Crete_2025/">andreastersenov.github.io/talks/TITAN_Saclay_2025/</a>
					</div> -->
					<div class="container">
						<div class="col">
							<div align="left" style="margin-left: 20px;">
								<h3>Andreas Tersenov</h3>
								<br>
								<img src="assets/ICS-for-print-en_cropped.png" class="plain" height="80"></img>
								<br>
							</div>
						</div>
						<div class="col">
							<br>
							<br>
							<br>
							<br>
							<img src="assets/logo-crete.png" class="plain" height="200"></img>
						</div>
						<div class="col">
							<br>
							<br>
							<br>
							<img src="assets/CosmoStatDarkBK.png" class="plain" height="100"></img>
						</div>
					</div>

				</div>
			</section>


			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">
					<b class="alert" style="border-radius: 10px; background-color: rgba(0, 0, 0, 0.8);">
						Introduction - Weak Lensing
					</b>
				</h3>
				<br>

				<div class="fragment fade-up">
					<div class="container"
						style="border-radius: 20px; background-color: rgba(0, 0, 0, 0.7); padding: 50px;">
						<div class="col">
							<ul>
								<li><b class="alert">Weak Lensing (WL)</b>: An observational technique in cosmology used
									to study the distribution of matter in the universe.</li>
								<br>
								<li><b class="alert">Principle:</b> Light from distant galaxies is deflected by
									gravitational fields, leading to subtle distortions in their observed images.</li>
								<br>
								<li><b class="alert">Weak Lensing Effect:</b> Small, coherent distortions in the shapes
									of background galaxies.</li>
							</ul>
						</div>

						<div class="col">
							<video src="assets/wl_animation.mp4" class="plain" style="height: 300px;" controls></video>
						</div>
					</div>
					<br>

					<div class="fragment fade-up">
						<div class="block">
							<div class="block-content">
								<ul style="list-style-type: square;">
									<li>WL provides a <span style="color: #ef4907;">direct measurement of gravitational
											distortions</span>.</li>
									<li>It allows us to <span style="color: #ef4907;">probe cosmic structure</span>,
										<span style="color: #ef4907;">study dark matter</span>, and <span
											style="color: #ef4907;">constrain cosmological parameters</span>.
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</section>
			<!-- ################################################################################################### -->
			<section>
				<h3 class="slide-title">Relation between <b class="alert">$\kappa$</b> and <b class="alert">$\gamma$</b>
				</h3>
				<span class="fragment fade-in">
					<img src="assets/Relation_btw_kappa_and_gamma.pdf" alt="Relation between $\kappa$ and $\gamma$"
						style="width:auto" ; height="300">
				</span>

				<span class="fragment fade-in">
					<div class="container">
						<div class="col">
							<ul>
								<li>From <b class="alert">convergence</b> to <b class="alert">shear</b>: $\,\, \gamma_i
									=
									\hat{P}_i \kappa$</li>
								<li>From <b class="alert">shear</b> to <b class="alert">convergence</b>: $\,\, \kappa =
									\hat{P}_1 \gamma_1 + \hat{P}_2 \gamma_2$</li>
							</ul>
						</div>
					</div>
					<br>
					<div class="container">
						<div class="col">
							<div class="block">
								<div class="block-title">
								</div>
								<div class="block-content">
									<span style="color: gray;"> $$ \hat{P}_1(k)=\dfrac{k_1^2 - k_2^2}{k^2}, \,\,
										\hat{P}_2(k)=\dfrac{2k_1k_2}{k^2} $$ </span>
								</div>
							</div>
						</div>
					</div>
				</span>
			</section>

			<!-- ################################################################################################### -->
			<section data-visibility="hidden">
				<section>
					<h3 class="slide-title">Bayesian reconstruction</h3>
					<span class="fragment fade-in">
						<div class="block">
							<div class="block-content">
								<ul>
									<li>Mass mapping problem &rarr; statistical inference problem</li>
									<li><b class="alert">Goal</b>: infer most probable value of $\kappa$-field given
										observed
										shear data
									</li>
								</ul>
							</div>
						</div>
						$$ \underbrace{p(\boldsymbol{\kappa} \mid \boldsymbol{\gamma}, \mathcal{M})}_{\text {Posterior
						}}
						\propto \underbrace{p(\gamma \mid \boldsymbol{\kappa}, \mathcal{M})}_{\text {likelihood }} \,\,
						\underbrace{p(\boldsymbol{\kappa} \mid \mathcal{M})}_{\text {prior }} $$
						<small> $\mathcal{M}$: cosmological model </small>
					</span>
					<br>
					<span class="fragment fade-in">
						<ul style="list-style-type: square">
							<li><b class="alert">Likelihood distribution</b>: prob. of observing $\gamma$ data given
								true
								$\kappa$ &rarr; encodes the forward process of the model &rarr; <em>contains the
									physics</em>
							</li>
							<br>
							<li><b class="alert">Prior distribution</b>: encodes the knowledge about the signal before
								observing
								data</li>
							<br>
							<ul>
								<li> <b class="alert">Log-likelihood</b> (when the noise is white Gaussian)
									$$\log p(\gamma \mid \kappa)=-\frac{1}{2}\left(\gamma-\mathbf{F}^* \mathbf{P F}
									\kappa\right)^{\dagger} \Sigma_n^{-1}\left(\gamma-\mathbf{F}^* \mathbf{P F}
									\kappa\right)+\text { constant }$$
								</li>
								<li><b class="alert">Maximum A Posteriori solution</b>
									$$\hat{x} = \arg \max_x \, \log p(y|x) + \log p(x)$$
								</li>
							</ul>
						</ul>
					</span>
				</section>

				<!-- ################################################################################################### -->

				<section>
					<h3 class="slide-title">Wiener filter</h3>
					<ul>
						<li>Assumes <b class="alert">prior</b> on $\kappa$ &rarr; <b class="alert">Gaussian random
								field</b> $p_{\rm Gauss}(\kappa) = \frac{1}{\sqrt{\det 2\pi \mathbf{S}}} \exp{\left( -
							\frac12 \tilde{\kappa}^{\dagger} \mathbf{S}^{-1} \tilde{\kappa} \right)}$</li>
						<br>
						<li>Likelihood (assuming uncorrelated, Gaussian noise) &rarr; also <b class="alert">Gaussian</b>
							$p(\mathbf{\gamma} | \kappa) = \frac{1}{\sqrt{2\pi\det \mathbf{N}}} \exp{\left[ -\frac12
							(\mathbf{\gamma - \mathbf{A} \mathbf{\kappa}})^{\dagger} \mathbf{N}^{-1} ( \gamma -
							\mathbf{A}
							\mathbf{\kappa} ) \right]}$</li>
						<br>
						<li>The Gaussian prior <em class="alert">encodes the assumption</em> that the fluctuations in
							the
							$\kappa$-field are well described by a Gaussian random field, with <b class="alert">power
								spectrum</b> given by the cosmological model</li>
					</ul>
					<br><br>
					<div class="block">
						<div class="block-title">Convergence power spectrum</div>
						<div class="block-content">
							$$ \langle \tilde{\kappa}(\boldsymbol{k}) \tilde{\kappa}^*(\boldsymbol{k}') \rangle =
							(2\pi)^2
							\delta_D(\boldsymbol{k} - \boldsymbol{k}') P_{\kappa}(k) $$
							Stat. measure of the spatial distribution of the convergence field &rarr; quantifies the
							amplitude of the fluctuations in κ as function of their spatial scale

						</div>
				</section>

				<!-- ################################################################################################### -->

				<section>
					<h3 class="slide-title">Wiener filter</h3>
					<div class="block">
						<div class="block-title">Wiener solution of the inverse problem</div>
						<div class="block-content">$$\hat{\kappa}_{\text {wiener }}=\arg \min _\kappa\left\|\Sigma^{-1 /
							2}\left(\gamma-\mathbf{F}^* \mathbf{P F} \kappa\right)\right\|_2^2+\log p_{\text {Gaussian
							}}(\kappa)$$</div>
					</div>
					<br>
					<ul>
						<li>This solution corresponds to the <b class="alert">maximum a posteriori</b> (MAP) solution
							under
							the assumption of a Gaussian prior on $\kappa$, and it matches the <b class="alert">mean</b>
							of
							the Gaussian posterior.</li>
					</ul>

					<br> <br>
					<div class="block">
						<div class="block-title">Wiener reconstruction</div>
						<div class="block-content">$$\hat{\kappa}_{\text {wiener }}=\mathbf{S} \mathbf{P}^{\dagger}
							\left[\mathbf{P} \mathbf{S} \mathbf{P}^{\dagger} + \mathbf{N} \right]^{-1} \tilde{\gamma}$$
						</div>
					</div>
				</section>

				<!-- ################################################################################################### -->

				<section>
					<h3 class="slide-title">Sparse recovery</h3>
					<ul>
						<li>Decomposes the signal into another domain (dictionary), where it is <b
								class="alert">sparse</b>
						</li>
						<br>
						<li>Implement the <em class="alert">wavelet transform</em> &rarr; decomposes the signal into <b
								class="alert">wavelet functions</b> (waveforms of limited duration with an average value
							of
							zero)</li>
					</ul>
					<img src="assets/starlet_vs_gaussian_scales_multiplots.pdf" alt="Wavelets of different scales"
						style="width: auto;">
					<ul>
						<li>Use <b class="alert">starlet wavelets</b> &rarr; represent well structures resembling the
							$\kappa$ of a <b class="alert">DM halo</b> (positive & isotropic)</li>
						<br>
						<li>The application of sparsity prior <em class="alert">enforces</em> a cosmological model where
							the
							matter field is a combination of spherically symmetric DM halos</li>
					</ul>
				</section>

				<!-- ################################################################################################### -->

				<section>
					<h3 class="slide-title">MCALens</h3>
					<ul>
						<li>Models $\kappa$-field as a sum of a <b class="alert">Gaussian</b> and <b
								class="alert">non-Gaussian</b> component
							$$\boxed{\kappa = \underbrace{\kappa_{\rm NG}}_{\text{Standard Wiener filter approach}} +
							\underbrace{\kappa_\rm G}_{\text{Modified wavelet approach}}}$$
							$$\min _{\kappa_G, \kappa_{N G}}\left\|\gamma-\mathbf{A}\left(\kappa_G+\kappa_{N
							G}\right)\right\|_{\Sigma_n}^2+C_{\mathrm{G}}\left(\kappa_G\right)+C_{\mathrm{NG}}\left(\kappa_{N
							G}\right) $$ </li>
						<br>
						<li><b class="alert">MCA</b> (morphological Component Analysis) performs an alternating
							minimization
							scheme:
							<br><br>
							<ul>
								<li>Estimate $\mathbf{\kappa}_{\mathrm{G}}$ assuming $\mathbf{\kappa}_{\mathrm{NG}}$ is
									known: $$\min _{\kappa_G}\left\|\left(\gamma-\mathbf{A}\kappa_{N G}\right)
									-\mathbf{A}\kappa_{G} \right\|_{\Sigma_n}^2+C_{\mathrm{G}}\left(\kappa_G\right)$$
								</li>
								<li>Estimate $\mathbf{\kappa}_{\mathrm{NG}}$ assuming $\mathbf{\kappa}_{\mathrm{G}}$ is
									known: $$\min _{\kappa_{NG}}\left\|\left(\gamma-\mathbf{A}\kappa_{G}\right)
									-\mathbf{A}\kappa_{NG}
									\right\|_{\Sigma_n}^2+C_{\mathrm{NG}}\left(\kappa_{NG}\right)$$
								</li>
							</ul>
						</li>
					</ul>
				</section>
			</section>

			<!-- ################################################################################################### -->

			<section data-visibility="hidden">
				<h3 class="slide-title">Overview of mass mapping methods</h3>
				<ul>
					<li class="fragment fade-in"><b class="alert">Wiener filter</b>: Prior on $\kappa$ &rarr; Gaussian
						random field, Likelihood
						&rarr; Gaussian, Solution &rarr; corresponds to MAP for gaussian $\kappa$</li>
					<br>
					<li class="fragment fade-in"><b class="alert">Sparse recovery</b>: Prior on $\kappa$ &rarr;
						sparse in wavelet basis, Enforces
						model where matter field is a combination of DM halos</li>
					</li>
					<br>
					<li class="fragment fade-in"><b class="alert">MCALens</b>:
						Models $\kappa$-field as sum of a Gaussian and a non-Gaussian component, Uses Morphological
						Component Analysis</li>
					<br>
					<li class="fragment fade-in"><b class="alert">Deep Learning Methods</b>:
						<ul>
							<li><b>DeepMass</b>: CNN with a U-Net-based architecture, prior from simulations</li>
							<li><b>DeepPosterior</b>: Probabilistic mass mapping with deep generative models,
								Prior from
								2pt statistics modelling at large scales &
								Deep Learning on simulations for small scales, Sampling with Annealed HMC</li>
						</ul>
					</li>
				</ul>
			</section>

			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">Mass mapping methods: </h3>

				<img src="assets/mass_maps_(ks_iks_mca)_transparent_dark.pdf" alt="Summary statistics" width="800px">


			</section>

			<!-- ################################################################################################### -->


			<section class="inverted" data-background="#000">
				<h2> Statistics</h2>
			</section>

			<!-- ################################################################################################### -->


			<section>
				<h3 class="slide-title">Higher Order Statistics: <b class="alert">Peak Counts</b></h3>
				<img src="assets/cosmology_with_maps.pdf" alt="Cosmology with maps" style="height: 450px;">

				<div class="block">
					<div class="block-content">
						<ul>
							<li> <b class="alert">Peaks</b>: local maxima of the SNR field $\nu =
								\dfrac{\left(\mathcal{W} \ast \kappa \right)(\theta_{\rm ker})}{\sigma_n^{\rm filt}}$
							</li>
							<br>
							<li> Peaks trace regions where the value of <b class="alert">$\kappa$ is high</b> &rarr;
								they are associated to
								<b class="alert">massive structures</b>
							</li>
						</ul>
					</div>
				</div>
			</section>

			<!-- ################################################################################################### -->

			<section data-visibility="hidden">
				<h3 class="slide-title">Peak funtions</h3>
				<ul>
					<li class="fragment fade-in">The <b class="alert">peak function</b> is the <b class="alert">number
							of
							peaks</b> in a map as a function of the <b class="alert">SNR</b> $\nu$</li>
				</ul>
				<img class="fragment fade-in" src="assets/PC_hist_all_methods_ks_iks_mca_dark2.pdf" alt="">
			</section>

			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">Wavelet peaks</h3>
				<ul>
					<!-- <li class="fragment fade-in">To access the signal in the $\kappa$-maps at <em class="alert">small
							scales</em>, where they are
						dominated by noise &rarr; need to <em class="alert">filter</em> them </li> -->

					<li class="fragment fade-in">We consider a <b class="alert">multi-scale analysis</b> compared to a
						single-scale analysis
					</li>

					<li class="fragment fade-in">Apply (instead of Gaussian filter) a <b class="alert">starlet
							transform</b> &rarr; allows us to
						represent an image $I$ as a sum of wavelet coefficient images and a coarse resolution image
						<!-- $$I(x,y) = c_J(x,y) + \sum_{j=1}^{j_{\rm max}} w_j(x,y) $$  -->
					</li>
				</ul>

				<span class="fragment fade-in">
					<img src="assets/starlet_transform.pdf" alt="Starlet transform" style="height: 250px;">
				</span>


				<span class="fragment fade-in">
					<ul>
						<li> Allows for the <b class="alert">simultaneous</b> processing of data at different scales
							&rarr;
							<b class="alert">efficiency</b>
						</li>

						<li> Each wavelet band covers a different frequency range, which leads to an almost <b
								class="alert">diagonal peak count covariance matrix</b> </li>
					</ul>
				</span>
			</section>

			<!-- ################################################################################################### -->

			<section data-visibility="hidden">
				<h3 class="slide-title">Wavelet peak funtions</h3>
				<img src="assets/MSPC_hist_ks_iks_mca_4_scales_dark.pdf" alt="">
			</section>

			<!-- ################################################################################################### -->

			<section data-visibility="hidden" class="inverted" data-background="#000">
				<h2> What happens if we consider all pixels instead of selecting multi-scale minima and maxima?</h2>
			</section>


			<!-- ################################################################################################### -->

			<section class="inverted" data-background="#000">
				<h2> Inference</h2>
			</section>

			<!-- ################################################################################################### -->
			<section data-visibility="hidden">
				<h3 class="slide-title">Inference with HOS</h3>
				<ul>
					<li class="fragment fade-in"> Use <b class="alert">$\texttt{cosmoSLICS}$</b> simulations: suite
						designed for the analysis of WL data beyond the standard 2pt cosmic shear
					</li>
					<br>
					<li class="fragment fade-in"> <b class="alert">$\texttt{cosmoSLICS}$</b> cover a wide parameter
						space in
						$\left[ \Omega_m, \sigma_8,
						w_0, h \right]$.</li>
					<br>
					<li class="fragment fade-in">For <b class="alert">Bayesian inference</b> &rarr; use a <b
							class="alert">Gaussian
							likelihood</b> for a cosmology independent covariance, and a <b class="alert">flat
							prior</b>. </li>
					<br>
					<li class="fragment fade-in">To have a prediction of each HOS <b class="alert">given a new set of
							parameters</b>&rarr; employ
						an interpolation with <b class="alert">Gaussian Process Regressor</b> (GPR)</li>
				</ul>
				<br><br><br>
				<!-- <div class="block; fragment fade-in">
					<div class="block-title">
						Gaussian Process
					</div>
					<div class="block-content">
						<ul>
							<li> A Gaussian process is a collection of random variables, any finite number of which have
								a joint Gaussian distribution.</li>
							<li> Assumes <em class="alert">smoothness</em> between parameters with close values </li>
							<li> Computes the prediction for peak counts at a new point in parameter space</li>
						</ul>

					</div> -->
			</section>

			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">From data to contours</h3>
				<img src="assets/data_to_contours2.pdf" alt="Contours" style="width:auto">
				<div class="block">

					<div class="block-content">
						<ul>
							<li> <b class="alert">$\mu$</b>: expected theoretical prediction, <b class="alert">$d$</b>:
								data array (mean over realizations of a HOS), <b class="alert">$C$</b>: covariance
								matrix </li>

						</ul>
					</div>
			</section>

			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">The (standard) mono-scale peak counts</h3>
				<div class="container">
					<div class="col">
						<img src="assets/triangle_plot_merged_sm04_sspc_GPypred_dark.pdf" alt="Mono-scale peak counts"
							style="width:auto">
					</div>
					<div class="col">
						<p>
						<div style="font-size: 0.8em; line-height: 1.2; display: inline-block;" width="100px">
							\[
							\begin{array}{lcccc}
							\hline \hline
							\text{FoM} & \text{KS} & \text{iKS} & \text{MCALens} \\
							\hline \hline
							\left(\Omega_m, h\right) & 476 & 453 & 450 \\
							\left(\Omega_m, w_0\right) & 152 & 141 & 233 \\
							\left(\Omega_m, \sigma_8\right) & 1323 & 1285 & 1740 \\
							\left(h, w_0\right) & 55 & 63 & 87 \\
							\left(h, \sigma_8\right) & 336 & 292 & 293 \\
							\left(w_0, \sigma_8\right) & 75 & 72 & 124 \\
							\hline
							\left(\Omega_m, h, w_0, \sigma_8\right) & 492 & 444 & 578 \\
							\hline
							\end{array}
							\]
						</div>
						</p>
					</div>

			</section>

			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">Wavelet multi-scale peak counts</h3>
				<div class="container">
					<div class="col">
						<img src="assets/countours_all_methods_MSPC_6scales_dark.pdf"
							alt="Wavelet multi-scale peak counts" style="width:auto">
					</div>
					<div class="col">
						<p>
						<div style="font-size: 0.8em; line-height: 1.2; display: inline-block;" width="100px">
							\[
							\begin{array}{lcccc}
							\hline \hline
							\text{FoM} & \text{KS} & \text{iKS} & \text{MCALens} \\
							\hline \hline
							\left(\Omega_m, h\right) & 670 & 702 & 2159 \\
							\left(\Omega_m, w_0\right) & 247 & 244 & 1051 \\
							\left(\Omega_m, \sigma_8\right) & 2414 & 2517 & 9039 \\
							\left(h, w_0\right) & 82 & 80 & 259 \\
							\left(h, \sigma_8\right) & 411 & 433 & 1335 \\
							\left(w_0, \sigma_8\right) & 131 & 129 & 577 \\
							\hline
							\left(\Omega_m, h, w_0, \sigma_8\right) & 758 & 755 & 1947 \\
							\hline
							\end{array}
							\]
						</div>
						</p>
					</div>


			</section>

			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">Where does this improvement come from?</h3>
				<img src="assets/countours_ks_different_scales_dark.pdf" alt="Wavelet multi-scale peak counts"
					style="width:auto">
				<img src="assets/countours_mca_different_scales_dark.pdf" alt="Wavelet multi-scale peak counts"
					style="width:auto">
			</section>
			<!-- ################################################################################################### -->

			<section data-visibility="hidden">
				<h3 class="slide-title">Conclusions</h3>
				<span class="fragment fade-in">
					<div class="block">

						<div class="block-content">
							<ul>
								<li>Investigated how different <b class="alert">mass mapping algorithms</b> affect <b
										class="alert">cosmological inference</b>
									using HOS from WL data.</li>
								<li>Estimated <b class="alert">posterior</b> distributions of $\Omega_\mathrm{m}$,
									$\sigma_8$, $h$, and $w_0$
									using <b class="alert">peak counts</b> and <b class="alert">wavelet peak counts</b>.
								</li>
							</ul>
						</div>
					</div>
				</span>
				<br><br>

				<span class="fragment fade-in">
					<div class="block">
						<div class="block-title">Results</div>
						<div class="block-content">
							<ul>
								<li> <b class="alert">MCALens Advantage</b>:
									<ul>
										<li>$\sim 17\%$ improvement in (FoM) over KS.</li>
										<li>$\sim 157\%$ improvement in FoM over KS.</li>
									</ul>
								<li> <b class="alert">KS vs. iKS</b>: No significant difference in constraints &rarr;
									inpainting does not
									improve
									performance</li>
								<li><b class="alert">Wavelet Peak Counts</b>: Provide tighter constraints than
									single-scale peak counts.</li>
								<li><b class="alert">MCALens and Multi-Scale Approach</b>: Captures more small-scale
									information, leading to
									the greatest improvement.</li>
							</ul>
						</div>
					</div>
				</span>
				<br>
				<span class="fragment fade-in">
					<div class="block">
						<div class="block-title"> Takeaway</div>
						<div class="block-content">
							<ul>
								<li><b class="alert">Careful Selection Matters</b>: Choosing an advanced mass mapping
									method
									significantly enhances constraints on cosmological parameters from HOS.</li>
							</ul>

			</section>

			<!-- ################################################################################################### -->

			<section class="inverted" data-background="#000">
				<h1>Alternative DL-based mass mapping method</h1>
			</section>

			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">A PnP approach with conformal predictions for mass mapping</h3>

				<div class="block">

					<div class="block-content">
						<ul>
							<li>
								Novel DL-based method for mass mapping
							</li>
							<br>
							<li>Combines <b class="alert">model driven</b> and <b class="alert">data driven</b>
								approaches &rarr; uses a Forward-Backward splitting algorithm with an on-the-shelf
								DL denoiser
							</li>
							<br>
							<li><b class="alert">Efficient</b> and <b class="alert">flexible</b> reconstruction,
								while
								incorporating knowledge about the <b class="alert">physics</b></li>
							<br>
							<li><b class="alert">Fast</b> at inference</li>
							<br>
							<li>Doesn't require <b class="alert">retraining</b> a full model for every galaxy survey
							</li>
							<br>
							<li>Provide robust <b class="alert">distribution-free UQ</b> without relying on
								sampling,
								and not assuming any prior on $\kappa$</li>

						</ul>
					</div>

			</section>

			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">A PnP approach with conformal predictions for mass mapping</h3>
				<img src="assets/pnp_rmse.png" style="width: 850px;">
				<span class="fragment fade-in">
					<div class="container">
						<div class="col">
							<img src="assets/cqr1.png" style="width:330px; height:auto;">
						</div>
						<div class="col" style="width: 400px;">
							<div class="block">
								<div class="block-content">
									<ul>
										<li>Use a UNet or SUNet as a denoiser</li>
										<li>Performs on par with state of the art DL methods (and sometimes better)
										</li>

										<li>Is faster, more robust and doesn't require retraining</li>

										<li>Incorporates distribution-free UQ through moment networks and CQR
											$$ \left\| G_\Omega (\gamma) - \left( \kappa - F_{\hat{\Theta}} (\gamma)
											\right)^2
											\right\|_2^2$$
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</span>

			</section>
			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title"> 2 point statistics is not sufficient </h3>
				<p>
					The PS shows power as the mean squared amplitude at each frequency line but includes no <b
						class="alert">phase</b> information. </p>

				<img src="assets/FT_demo1.png" class="plain" style="height: 550px;">
			</section>
			<!-- ######################################################################################################################################################################### -->
			<section>
				<h3 class="slide-title"> 2 point statistics is not sufficient </h3>
				<p>
					The PS shows power as the mean squared amplitude at each frequency line but includes no <b
						class="alert">phase</b> information. </p>

				<img src="assets/FT_demo2.png" class="plain" style="height: 550px;">
			</section>


			<!-- ######################################################################################################################################################################### -->
			<section>
				<h3 class="slide-title">Starlet $\ell_1$-norm</h3>
				<ul>
					<li class="fragment fade-in">New higher order summary statistic for weak lensing observables
					</li>
					<li class="fragment fade-in">Provides a fast multi-scale calculation of the full void and peak
						distribution</li>
					<li class="fragment fade-in"><b class="alert">$\ell_1$-norm</b> = sum of absolute values of the
						starlet decomposition
						coefficients of a weak lensing map </li>
				</ul>

				<span class="fragment fade-in">
					<img src="assets/wavelet_l1_norm.pdf" alt="Wavelet l1 norm" style="height: 200px;">

					$$ \boxed{ \ell_1^{j,i} = \sum_{u=1}^{\textrm{\# coef}(\mathcal{S}_{i,j})} \left|
					\mathcal{S}_{j,i}
					[u]
					\right| = \| \mathcal{S}_{j,i} \|_1} \, , \,\, \mathcal{S}_{j,i} = \{ w_{j,k}/B_i w_{j,k}
					B_{i+1}
					\}$$

				</span>

				<div class="block; fragment fande-in">
					<div class="block-title"></div>
					<div class="block-content">
						<span style="color: #49b649;">
							<ul>
								<li> Information encoded in <b class="alert">all</b> pixels (automatically includes
									peaks and voids)
								</li>

								<li>Multi-scale approach</li>

								<li>Avoids the problem of defining peaks and voids</li>

								<li>Theoretical prediction from LDT</li>
							</ul>
						</span>
					</div>
				</div>
			</section>


			<!-- ######################################################################################################################################################################### -->

			<section>
				<h2 class="section-title">Theory prediction for starlet $\ell_1$-norm</h2>
				<br>
				<div class="row">
					<div class="container">
						<div class="col">

							<image src="assets/alltheta_z1_4.png" class="plain" style="height: 450px;" controls>
							</image>
						</div>
						<div class="col">
							<image src="assets/derivative_l1.png" class="plain" style="height: 450px;" controls>
							</image>
						</div>
					</div>
					<h4>Sreekanth, V. T., Codis, S., Barthelemy, A., & Starck, J.-L. 2024, A&A, 691,A80</h4>
				</div>
			</section>

			<!-- ######################################################################################################################################################################### -->

			<section class="inverted" data-background="#000">
				<section>
					<h2>Is there an alternative to using N-body simulations?</h2>
				</section>
				<section>
					<h2>Why Simulations are needed?</h2>
					<ul>
						<li>Cannot model the systematics in theory directly</li>
						<li>Systematic effects can be directly incorporated in simulations</li>
						<li>Combination of multiple probes</li>
						<li>Helps in understanding the relation between theory and observation</li>
					</ul>
				</section>
			</section>

			<!-- ######################################################################################################################################################################### -->
			<section>
				<section>

					<div class="col">
						<h2>Simulation Challenges</h2>
						<ul>
							<li>Multiple realizations required</li>
							<li>High computational cost</li>
							<li>Resource intensive</li>
						</ul>
					</div>
					<div class="col">
						<br>
						<br>
						<h2>Alternative: Emulation</h2>
						<ul>
							<li>Approximate methods or NN based methods to predict simulation outputs</li>
							<li>Fast and efficient</li>
							<li>Cost-effective</li>
							<li><span style="color: #ef4907;"> They might not always have correct HOS
									incorporated!</span></li>
						</ul>
					</div>
					<br>

				</section>
				<!-- <section>
					<img src="assets/lognormal_comparision.png" class="plain" style="height: 600px;" controls></img>
				</section> -->
			</section>



			<!-- ######################################################################################################################################################################### -->
			<section>
				<h2>Build an emulator using generalised forward backward method</h2>
				<br>
				<div class="container_">
					<div class="row_">
						<div class="square_big">Initial Map</div>
						<div class="col">
							<div class="row">
								<div class="arrow">➡️</div>
								Apply $\ell_1$ norm constraint
							</div>
							<br>
							<div class="row">
								<div class="arrow">➡️</div>
								Apply Cls constraint
							</div>
						</div>
						<div class="col">
							<div class="square_small">Modified map with correct l1</div>
							<br>
							<div class="square_small">Modified map with correct Cls</div>
						</div>
						<div class="col">
							<div class="row">
								<div class="arrow">➡️</div>
							</div>
							<div class='row'>
								Average over the two
							</div>
						</div>
						<div class="square_big">Emulated map</div>
					</div>
			</section>

			<!-- ######################################################################################################################################################################### -->

			<section>
				<h3 class="slide-title">Emulated $\kappa$-fields</h3>
				<div class="container" style="border-radius: 20px; ">
					<div class="col">
						<image src="assets/maps-tophat.png" class="plain" style="height: 300px;" controls></image>
					</div>

				</div>
				<div class="container" style="border-radius: 20px; ">
					<div class="col">
						<image src="assets/residual-tophat.png" class="plain" style="height: 300px;" controls>
						</image>
					</div>
				</div>
			</section>

			<!-- ######################################################################################################################################################################### -->

			<section>
				<div class="container" style="border-radius: 20px; background-color:rgba(0, 0, 0, 0.7)">
					<div class="col">
						<image src="assets/tophat-emulation.png" class="plain" style="height: 550px;" controls>
						</image>
					</div>
					<div class="col">
						<image src="assets/cls_tophat.png" class="plain" style="height: 550px;" controls></image>
					</div>
				</div>
			</section>
			<!-- ######################################################################################################################################################################### -->


			<section>
				<h3 class="slide-title">Assessing Baryonic Feedback in WL</h3>
				<div class="col r-stack">

					<div class="container">
						<div class="col">
							<img class="fragment current-visible" data-fragment-index="0"
								data-src="assets/shp_map_cosmoGRID.pdf" style="width=600px">
						</div>
						<div class="col">
							<img class="fragment current-visible" data-fragment-index="0"
								data-src="assets/baryons_ps_residuals.png" />
						</div>
					</div>

					<div class="container">
						<div class="col">
							<img class="fragment" data-fragment-index="1" data-src="assets/sph_wavelet3.pdf" />
						</div>
						<div class="col">
							<img class="fragment" data-fragment-index="1" data-src="assets/baryons_l1_residuals.png" />
						</div>
					</div>
				</div>

			</section>
			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">Noiseless case</h3>
				<div class="col r-stack">
					<img class="fragment current-visible" data-fragment-index="0"
						data-src="assets/NoBar_vs_Bar_scale1_dark.pdf" style="height: 650px;" />
					<img class="fragment" data-fragment-index="1" data-src="assets/NoBar_vs_Bar_scale2_dark.pdf"
						style="height: 650px;" />
				</div>

			</section>
			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">Realistic case (noise and masks)</h3>
				<div class="col r-stack">
					<img class="fragment current-visible" data-fragment-index="0"
						data-src="assets/NoBar_vs_Bar_scale1_noisy_dark.pdf" style="height: 650px;" />
					<img class="fragment" data-fragment-index="1" data-src="assets/NoBar_vs_Bar_scale2_noisy_dark.pdf"
						style="height: 650px;" />
				</div>

			</section>
			<!-- ################################################################################################### -->

			<section>
				<h3 class="slide-title">After BNT</h3>


				<div class="container">
					<div class="col">
						<img class="fragment" data-fragment-index="0" data-src="assets/PS_after_BNT.png"
							style="width=600px">
					</div>
					<div class="col">
						<div class="col r-stack">
							<img class="fragment current-visible" data-fragment-index="0"
								data-src="assets/w0_after_BNT.png" />
							<img class="fragment" data-fragment-index="1" data-src="assets/w1_after_BNT.png" />
							<img class="fragment" data-fragment-index="2" data-src="assets/w2_after_BNT.png" />
						</div>

					</div>
				</div>


			</section>
			<!-- ################################################################################################### -->









		</div>
	</div>

	<style>
		/* .reveal .slides {
			border: 5px solid red;
			min-height: 100%;
			width: 128mm;
			height: 96mm;
		} */

		.reveal .block {
			background-color: #191919;
			margin-left: 20px;
			margin-right: 20px;
			text-align: left;
			padding-bottom: 0.1em;
		}

		.reveal .block-title {
			background-color: #333333;
			padding: 8px 35px 8px 14px;
			color: #FFAA7F;
			font-weight: bold;
		}

		.reveal .block-content {
			padding: 8px 35px 8px 14px;
		}

		.reveal .slide-title {
			border-left: 5px solid white;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
		}

		.reveal .alert {
			color: #FFAA7F;
			font-weight: bold;
		}

		.reveal .inverted {
			filter: invert(100%);
		}

		.row_ {
			display: flex;
			align-items: center;
			gap: 20px;
		}

		.square_big {
			background: linear-gradient(to bottom, #f8f8f8, #ddd);
			color: black;
			padding: 20px;
			/* Reduce padding to avoid affecting square shape */
			border-radius: 10px;
			font-weight: bold;
			width: 200px;
			/* Set fixed width */
			height: 200px;
			/* Set fixed height */
			text-align: center;
			display: flex;
			/* Use flexbox to center text */
			justify-content: center;
			align-items: center;
			box-shadow: 3px 3px 3px rgba(255, 255, 255, 0.2);
		}

		.square_small {
			background: linear-gradient(to bottom, #f8f8f8, #ddd);
			color: black;
			padding: 20px;
			/* Reduce padding to avoid affecting square shape */
			border-radius: 10px;
			font-weight: bold;
			width: 120px;
			/* Set fixed width */
			height: 120px;
			/* Set fixed height */
			text-align: center;
			display: flex;
			/* Use flexbox to center text */
			justify-content: center;
			align-items: center;
			box-shadow: 3px 3px 3px rgba(255, 255, 255, 0.2);
		}

		.box {
			background: linear-gradient(to bottom, #f8f8f8, #ddd);
			color: black;
			padding: 20px 40px;
			border-radius: 12px;
			font-size: 1.5em;
			font-weight: bold;
			box-shadow: 3px 3px 10px rgba(255, 255, 255, 0.2);
		}

		.arrow {
			font-size: 2em;
		}

		.subtext {
			font-size: 0.9em;
			color: #3faf61;
			margin-top: 5px;
		}

		.highlight_box {
			background: linear-gradient(to bottom, #9784e3, #d5bef7);
			/* Warm highlight */
			box-shadow: 0px 0px 15px rgba(167, 158, 175, 0.8);
			/* Glow effect */
			color: black;
			font-weight: bold;
		}

		.iteration {
			margin-top: 20px;
			font-size: 1.2em;
			font-style: italic;
			border-top: 2px solid white;
			padding-top: 10px;
			width: 80%;
		}

		.container_ {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 20px;
		}
	</style>


	<script src="reveal.js/dist/reveal.js"></script>
	<script src="reveal.js/plugin/notes/notes.js"></script>
	<script src="reveal.js/plugin/markdown/markdown.js"></script>
	<script src="reveal.js/plugin/highlight/highlight.js"></script>
	<script src="reveal.js/plugin/math/math.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			controls: true,
			controlsBackArrows: 'faded',
			progress: true,
			slideNumber: 'c/t',
			hash: true,
			transition: 'slide',

			// The "normal" size of the presentation, aspect ratio will be preserved
			// when the presentation is scaled to fit different resolutions. Can be
			// specified using percentage units.
			width: 1200,
			height: 720,

			// Factor of the display size that should remain empty around the content
			margin: 0.1,

			// Bounds for smallest/largest possible scale to apply to content
			minScale: 0.2,
			maxScale: 1.5,

			autoPlayMedia: true,

			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath],

			dependencies: [{
				src: 'reveal.js/plugin/markdown/marked.js'
			},
			{
				src: 'reveal.js/plugin/markdown/markdown.js'
			},
			{
				src: 'reveal.js/plugin/notes/notes.js',
				async: true
			},
			{
				src: 'reveal.js/plugin/math/math.js',
				async: true
			},
			{
				src: 'reveal.js/plugin/reveal.js-d3/reveald3.js'
			},
			{
				src: 'reveal.js/plugin/reveal.js-plugins/chart/Chart.min.js'
			},
			{
				src: 'reveal.js/plugin/reveal.js-plugins/chart/csv2chart.js'
			},
			{
				src: 'reveal.js/plugin/highlight/highlight.js',
				async: true
			},
			]
		});
	</script>
</body>

</html>